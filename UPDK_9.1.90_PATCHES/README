###################################################################################
#   Release Highlights                                                            #
###################################################################################

1. Fix for DUT Hung on 'reboot -f'
2. Fix for wlan client connection to the Ap
3. Fix for building mutiple u-boot variants
4. Fix for dnsmasq-prpl package build failure

###################################################################################
#   List of patches                                                               #
###################################################################################
The Release is provided with a patch each per fix mentioned in the highlights.

1. reboot-fix.patch
2. wlan-client-connect-fix.patch
3. 0001-multi-uboot-installation-fix.patch
4. feed-prplos.patch

###################################################################################
Building the UPDK-9.1.90 Day0 patch release                                          #
###################################################################################
The patches provided with this release need to be applied on top of UPDK-9.1.90.
Execute the below steps to apply UPDK-9.1.90 Day0 patches on MxL25641 Secure boot model.


1. Clone prplOS repository from prpl Foundation:
   git clone -b mainline-23.05 https://gitlab.com/prpl-foundation/prplos/prplos

2. Select the configuration to build and synchronize files for building the UPDK Software.
   The commit hash provided corresponds to prplos commit on 6th May 2025:

   cd prplos
   git checkout 3d577798db3d05b4d1c969ed82e732f9499092f8

3. Clone the mxl_profiles repository from git.maxlinear.com to obtain the required profile for all platforms.

   git clone -b updk_9.1.90 git@git.maxlinear.com:mxl/mxl_profiles.git
   cp mxl_profiles/profiles/* profiles/

4. Run the command which corresponds to the model:
   a) MxL25641‑HDK‑2/URX851‑HDK‑2 with Secure boot
      ./scripts/gen_config.py mxl_x86_mb_urx_sec.yml mxl_wlan_hostap_ng_wav700_cust prpl
   b) MxL25641‑HDK‑2/URX851‑HDK‑2
      ./scripts/gen_config.py mxl_x86_mb_urx.yml mxl_wlan_hostap_ng_wav700_cust prpl
   c) OSPv2
      ./scripts/gen_config.py mxl_x86_osp_tb341_v2 mxl_wlan_hostap_ng_wav700_cust prpl
   d) OSPv2-B
      ./scripts/gen_config.py mxl_x86_osp_wgrtd159be_b_v2 mxl_wlan_hostap_ng_wav700_cust prpl

5. Install the necessary patches to upgrade PWHM to version 7.6.19 and PrplMesh to version 5.0.0-rc4.
   These patches are located in the 'patches' folder of the cloned mxl_profiles repository.
   These patches are necessary until the updated versions are integrated into the Prpl community releases, and the corresponding prplos version is used.

   a) cd feeds/feed_prplmesh/
   b) copy feed_prplmesh.patch from 'patches' folder of mxl_profiles repository.
   c) patch -p1 < feed_prplmesh.patch
   d) cd - to switch to prplos directory.


6. Clone the updk_patches repository from git.maxlinear.com to obtain the required UPDK-9.1.90 Day0 patches.

   git clone git@git.maxlinear.com:mxl-external-share/updk_patches.git

7.     Install the UPDK-9.1.90 Day0 patches.
        a)      cd feeds/wlan_6x/
        b)      copy wlan-client-connect-fix.patch from updk_patches/UPDK_9.1.90_PATCHES folder to present directory
        c)      copy reboot-fix.patch from updk_patches/UPDK_9.1.90_PATCHES folder to present directory
        d)      patch -p1 < wlan-client-connect-fix.patch
        e)      patch -p1 < reboot-fix.patch
        f)      cd - to switch to prplos directory.
        g)      cd feeds/bootloader
        h)      copy 0001-multi-uboot-installation-fix.patch from updk_patches/UPDK_9.1.90_PATCHES folder to present directory
        i)      patch -p1 < 0001-multi-uboot-installation-fix.patch
        j)      cd - to switch to prplos directory.

8. Enter this command to start the build:
   make -j8

Note: If dnsmasq-prpl package build fails due to package download issue (PPW-570), Please use below steps to apply patch and
      continue build.
        a)      cd feeds/feed_prplos
        b)      copy feed-prplos.patch from updk_patches/UPDK_9.1.90_PATCHES folder to present directory
        c)      patch -p1 < feed-prplos.patch
        d)      cd - to switch to prplos directory.
